<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0">
    <title>three.js css2d - label</title>
    <link type="text/css" rel="stylesheet" href="main.css">
    <style>
        .label {
            color: #FFF;
            font-family: sans-serif;
            font-size: 1.5em;
            padding: .2em;
            background: rgba(120, 120, 120, .6);
            border-radius: .2em;
        }

    </style>
</head>

<body>
    <script async src="https://unpkg.com/es-module-shims@1.3.6/dist/es-module-shims.js"></script>
    <script type="importmap">
			{
				"imports": {
					"three": "../build/three.module.js",
					"three/addons/": "./jsm/"
				}
			}
    </script>
    <script type="module">
        import * as THREE from 'three'
        import {OrbitControls} from 'three/addons/controls/OrbitControls.js'
        import {CSS2DRenderer, CSS2DObject} from 'three/addons/renderers/CSS2DRenderer.js'
        import {GUI} from 'three/addons/libs/lil-gui.module.min.js'

        let gui
        let camera, scene, renderer, labelRenderer
        const layers = {
            'Dirk': function () {
                camera.layers.toggle(0)
            },
            'Toggle Name': function () {
                camera.layers.toggle(0)
            },
            'Toggle Mass': function () {
                camera.layers.toggle(1)
            },
            'Enable All': function () {
                camera.layers.enableAll()
            },
            'Disable All': function () {
                camera.layers.disableAll()
            }
        }

        const textureLoader = new THREE.TextureLoader()

        init()
        animate()

        function init() {
            const EARTH_RADIUS = 1
            camera = new THREE.PerspectiveCamera(45, window.innerWidth / window.innerHeight, 0.1, 200)
            camera.position.set(10, 5, 20)
            camera.layers.enableAll()
            camera.layers.toggle(1)

            scene = new THREE.Scene()

            const dirLight = new THREE.DirectionalLight(0xffffff)
            dirLight.position.set(-1, -1, 1)
            dirLight.layers.enableAll()
            scene.add(dirLight)

            const earthGeometry = new THREE.SphereGeometry(EARTH_RADIUS, 64, 64)
            const earthMaterial = new THREE.MeshPhongMaterial({
                specular: 0x333333,
                shininess: 5,
                map: textureLoader.load('earth-day.jpg'),
                specularMap: textureLoader.load('earth-bump.jpg'),
                normalMap: textureLoader.load('earth-bump.jpg'),
                normalScale: new THREE.Vector2(0.85, 0.85)
            })
            const earth = new THREE.Mesh(earthGeometry, earthMaterial)
            scene.add(earth)

            const earthDiv = document.createElement('div')
            earthDiv.className = 'label'
            earthDiv.textContent = 'Earth'
            earthDiv.style.marginTop = '-1em'
            const earthLabel = new CSS2DObject(earthDiv)
            earthLabel.position.set(1, EARTH_RADIUS, 1)
            earth.add(earthLabel)
            earthLabel.layers.set(0)

            renderer = new THREE.WebGLRenderer()
            renderer.setPixelRatio(window.devicePixelRatio)
            renderer.setSize(window.innerWidth, window.innerHeight)
            document.body.appendChild(renderer.domElement)

            labelRenderer = new CSS2DRenderer()
            labelRenderer.setSize(window.innerWidth, window.innerHeight)
            labelRenderer.domElement.style.position = 'absolute'
            labelRenderer.domElement.style.top = '0px'
            document.body.appendChild(labelRenderer.domElement)

            const controls = new OrbitControls(camera, labelRenderer.domElement)
            controls.minDistance = 5
            controls.maxDistance = 100

            initGui()

        }



        function animate() {

            requestAnimationFrame(animate)
            renderer.render(scene, camera)
            labelRenderer.render(scene, camera)

        }

        //

        function initGui() {

            gui = new GUI()

            gui.add(layers, 'Toggle Name')
            gui.add(layers, 'Toggle Mass')
            gui.add(layers, 'Enable All')
            gui.add(layers, 'Disable All')
            gui.add(layers, 'Dirk')

        }

    </script>
</body>

</html>
